# درس ۳: مهندسی پرامپت

در این فصل یاد خواهید گرفت:

- مهندسی پرامپت چیست و چگونه دانستن اصول اولیه می‌تواند به شما کمک کند نتایج بهتری بگیرید.
- تکنیک‌های مختلف مهندسی پرامپت و چگونگی کمک آن‌ها برای ارائه نتایج بهتر در سناریوهای مختلف.
- متا پرامپت‌ها چیستند و چگونه می‌توانند خروجی را محدود کنند، اطمینان حاصل کنند که قابل دسترس است و تجربه کاربری بهتری ارائه دهند.

## راه‌اندازی

اگر قبلاً این کار را نکرده‌اید، محیط توسعه خود را راه‌اندازی کنید. در اینجا نحوه انجام آن آورده شده است: [راه‌اندازی محیط شما](/docs/setup/README.md).

## منابع مرتبط

[![تماشای یک ویدئوی کوتاه درباره مهندسی پرامپت](https://img.youtube.com/vi/gQ6TlyxBmWs/0.jpg)](https://www.youtube.com/watch?v=gQ6TlyxBmWs&list=PLlrxD0HtieHi5ZpsHULPLxm839IrhmeDk&index=3)

_این ویدئو مقدمه‌ای برای بهبود مهارت‌های "پرامپت" شما ارائه می‌دهد، به شما آموزش می‌دهد که چگونه دستورالعمل‌های واضح‌تر و مؤثرتری به هوش مصنوعی بدهید تا نتایج بهتری کسب کنید._

*🎥 برای تماشای یک ویدئوی کوتاه درباره مهندسی پرامپت روی تصویر بالا کلیک کنید*

💼 اسلایدها: [مهندسی پرامپت](/videos/slides/02-prompt-engineering.pptx)

## روایت: بلیط سوار شدن

> [!NOTE] 
> تاکنون، شما در یک سفر در زمان با لئوناردو داوینچی بوده‌اید، شگفتی‌های رنسانس را کاوش کرده‌اید. شما با سوسک زمان، یک دستگاه مرموز که به شما امکان سفر در زمان و مکان را می‌دهد، روبرو شده‌اید.
>
> اگر می‌خواهید داستان را از ابتدا دنبال کنید، [درس ۱](../01-intro-to-genai/README.md) را ببینید. 

> [!NOTE] 
> در حالی که ما توصیه می‌کنیم از داستان عبور کنید (سرگرم‌کننده است!)، [اینجا را کلیک کنید](#interact-with-sforza) اگر ترجیح می‌دهید مستقیماً به محتوای فنی بروید.

**شما:** بگذارید ببینم آیا می‌توانم به خانه برگردم. 

قبل از اینکه بتوانید دکمه را فشار دهید، درهای کارگاه با صدای بلندی باز می‌شوند. مردی در ورودی ایستاده است، شانه‌های پهن و لباس‌های گران‌قیمت، او تکه‌ای کاغذ را در هوا تکان می‌دهد و فریاد می‌زند:

<div>
  <img src="./assets/ludovico.png" alt="لودوویکو اسفورزا با خشم از در وارد می‌شود" width="300">
</div>

*لودوویکو اسفورزا* 

**اسفورزا**: داوینچی، نقاشی من کجاست؟ Where is my painting?

**لئوناردو:** این اسفورزا است. او می‌خواهد یک نقاشی را کامل کنم، 'شام آخر'.

**شما:** نمی‌توانستی فقط به او بگویی؟

**لئوناردو:** سعی کرده‌ام، اما او مرد صبوری نیست.

شما به دنبال لئوناردو می‌دوید، از در پشتی به یک کوچه تاریک می‌روید، اسب و کالسکه‌ای را پیدا می‌کنید که منتظر است.

لئوناردو افسار را می‌گیرد و هر دو به داخل کالسکه می‌پرید. با تازیانه‌ای تیز، اسب به حرکت درمی‌آید و از خیابان‌های باریک فلورانس می‌گذرد.

**لئوناردو:** سعی کن آن وسیله را فشار دهی، آن‌ها نزدیک می‌شوند!

**شما:** "خوب، سوسک زمان، با دقت گوش کن. من باید به زمان حال برگردم، خانه، خوب؟" ناگهان، کالسکه به یک دست‌انداز برخورد می‌کند و سوسک زمان از دست شما خارج می‌شود و روی زمین می‌افتد. شروع به بوق زدن می‌کند و با صدایی رباتیک اعلام می‌کند، "به رم می‌رویم."

**شما:** نه، رم نه، خانه... خانه...

چرخشی از رنگ‌ها کالسکه را دربرمی‌گیرد، جهان اطراف شما به یک کالیدوسکوپ از نور تبدیل می‌شود.

## فرار

چرخش رنگ‌ها محو می‌شود و خود را در کالسکه می‌بینید، اکنون در حال دویدن در Via Appia در رم هستید و با تعجب، در وسط یک مسابقه اسب هستید. ارابه‌ها با سرعت می‌گذرند، چرخ‌های آن‌ها ابری از گرد و غبار به هوا بلند می‌کند. 

<div>
  <img src="./assets/escape.png" alt="فرار از رم" width="300">
</div>

**شما:** لئوناردو، کجا هستیم؟ 

**لئوناردو:** به نظر می‌رسد در وسط یک مسابقه هستیم! باید از اینجا خارج شویم! 

شما کناره‌های کالسکه را محکم می‌گیرید در حالی که از میان آشوب می‌گذرد. سربازان رومی سوار بر اسب در حال نزدیک شدن هستند، زره آن‌ها در نور خورشید می‌درخشد. 

**شما**: آنجا! به سمت بندر برو!

لئوناردو کالسکه را به سمت خروجی هدایت می‌کند، چرخ‌ها روی سنگ‌فرش‌ها می‌لغزند. فریادهای سربازان در گوش شما طنین‌انداز می‌شود. 

**لئوناردو:** باید از آن‌ها فرار کنیم! به دنبال جایی برای پنهان شدن بگرد!

شما خیابان‌های باریک را بررسی می‌کنید، قلب شما به تپش می‌افتد. 

**شما:** آنجا! یک کوچه پشتی!

لئوناردو به داخل کوچه می‌پیچد، کالسکه در پیچ تنگ تکان می‌خورد. شما از کالسکه خارج می‌شوید و به لئوناردو کمک می‌کنید تا یک دستگاه بزرگ را از پشت بیرون بکشید. این اختراع او است—پیچ هوایی.

**لئوناردو:** سریع، باید این را به پشت بام برسانیم!

هر دو زیر وزن دستگاه فشار می‌آورید. صدای تعقیب سربازان بلندتر می‌شود، قدم‌های آن‌ها از دیوارها بازتاب می‌یابد. شما به پشت بام می‌رسید، نفس‌نفس می‌زنید و عرق می‌کنید.

**لئوناردو:** کمکم کن آن را تنظیم کنیم!

با هم کار می‌کنید، دست‌های شما با دقت تمرین شده حرکت می‌کنند. هر دو روی دستگاه می‌پرید، قلب شما در سینه می‌تپد.

**لئوناردو:** محکم بگیر!

با فشار نهایی، پیچ هوایی شروع به چرخش می‌کند. تیغه‌ها هوا را می‌گیرند و شما احساس می‌کنید که ناگهان بالا می‌روید. زمین زیر پای شما ناپدید می‌شود در حالی که دستگاه بلند می‌شود و بالای سقف‌های رم پرواز می‌کند. 

**شما:** انجامش دادیم، لئوناردو! ما در حال پرواز هستیم!

**لئوناردو:** بله، اما باید جای امنی برای فرود پیدا کنیم.

شما به شهر نگاه می‌کنید؛ ساختمان‌های باستانی زیر شما گسترده شده‌اند.

<div>
  <img src="./assets/airborne.png" alt="در هوا، به شهر با پاهای آویزان نگاه می‌کند" width="300">
</div>

## تعامل با اسفورزا

اگر می‌خواهید با اسفورزا تعامل داشته باشید، برنامه [شخصیت‌ها](/app/README.md) را اجرا کنید. 

> [!IMPORTANT]
> این کاملاً تخیلی است؛ پاسخ‌ها توسط هوش مصنوعی تولید می‌شوند.
> [سلب مسئولیت هوش مصنوعی مسئول](/README.md#responsible-ai-disclaimer)

<div >
  <img  src="./assets/ludovico.png" alt="لودوویکو اسفورزا" width="300" >
</div>

**مراحل**:

1. یک [![GitHub Codespace](https://img.shields.io/badge/GitHub-Codespace-brightgreen)](https://codespaces.new/microsoft/generative-ai-with-javascript) شروع کنید.
2. به _/app_ در ریشه مخزن بروید.
3. کنسول را پیدا کنید و `npm install` و سپس `npm start` را اجرا کنید.
4. هنگامی که ظاهر شد، دکمه "Open in Browser" را انتخاب کنید.
5. با اسفورزا چت کنید.

برای توضیح دقیق‌تر برنامه، [توضیح دقیق برنامه](/lessons/01-intro-to-genai/README.md#interact-with-dinocrates) را ببینید.

> [!NOTE]
 > اگر پروژه را به صورت محلی روی ماشین خود اجرا می‌کنید، لطفاً راهنمای QuickStart را مرور کنید تا تنظیم [دسترسی شخصی GitHub](/docs/setup/README.md#creating-a-personal-access-token-pat-for-github-model-access) را انجام دهید و کلید را در کد جایگزین کنید.

## مهندسی پرامپت چیست؟

**سوسک زمان:** باید در مورد مهندسی پرامپت صحبت کنیم.

**شما:** باید؟ آن چیست؟

**سوسک زمان:** مهندسی پرامپت با وجود نامش، درباره ساخت پل یا جاده نیست، بلکه درباره ساخت «پرامپت‌های» مناسب برای دریافت خروجی مطلوب از یک مدل زبانی هوش مصنوعی تولیدی است.

**شما:** خوب، اما چرا مهم است که من این را بدانم؟

**سوسک زمان:** خوب، شما می‌خواهید پیچ هوایی را فرود بیاورید، درست است؟

**شما:** بله، ترجیحاً در یک تکه. :-)

**سوسک زمان:** فکر می‌کردم چنین است، حالا گوش کن! مهندسی پرامپت درباره ساخت پرامپت‌های مناسب برای دریافت خروجی مطلوب از یک مدل زبانی است.

**سوسک زمان** مدل‌های زبانی بزرگ دارای چیزی به نام _ویژگی‌های ظهور یافته_ هستند، که به این معنی است که این ویژگی‌ها به صراحت در مدل برنامه‌ریزی نشده‌اند، بلکه از طریق آموزش روی حجم عظیمی از داده‌های متنی به دست می‌آیند. با مطالعه این ویژگی‌های ظهور یافته، می‌توانید نتیجه‌گیری کنید و الگوهایی را کشف کنید که می‌توانند به شما کمک کنند نتایج بهتری از مدل بگیرید.

**شما:** خوب، بنابراین الگوهایی وجود دارد که می‌توانیم کشف کنیم و به ما کمک کنند نتایج بهتری از مدل بگیریم. اما این چگونه به من کمک می‌کند پیچ هوایی را فرود بیاورم؟

**سوسک زمان:** بله درست است، و وای، شما آدم صبوری نیستی، هستی؟

**شما:** خوب، شما هم اگر در یک دستگاه بدون دستورالعمل فرود واضح پرواز می‌کردید، صبور نبودید.

**سوسک زمان:** من همینجا با تو هستم، می‌دانی، اما بگذارید به موضوع برگردیم.

## چگونه مهندسی پرامپت می‌تواند به توسعه‌دهندگان برنامه کمک کند

**سوسک زمان:** به عنوان یک متخصص، توانایی ساخت یک پرامپت بهتر مهارتی است که می‌خواهید در جعبه ابزار خود داشته باشید.

با نگاه از دیدگاه یک توسعه‌دهنده، می‌توانید از مهندسی پرامپت برای:

- **دریافت نتایج دقیق‌تر** از مدل زبانی خود و در نهایت بهبود تجربه کاربری برنامه خود استفاده کنید.

- **کنترل خروجی** مدل برای اطمینان از مرتبط و مناسب بودن برای کاربران خود. این به ویژه هنگام پرداختن به موضوعات حساس و همچنین برای محافظت از اعتبار برند شما مهم است.

- **قالب‌بندی خروجی** به روشی که درک و مصرف آن آسان باشد. در فصل بعدی بیشتر به این جنبه خواهیم پرداخت.

**سوسک زمان:** بیایید تکنیک‌ها و استراتژی‌های مختلفی را که می‌توانید برای ساخت پرامپت‌های مؤثر برای مدل زبانی خود استفاده کنید، بررسی کنیم.

## تکنیک‌ها و استراتژی‌های مهندسی پرامپت

**سوسک زمان:** در اینجا چند تکنیک و استراتژی وجود دارد که می‌توانید برای ساخت پرامپت‌های مؤثر استفاده کنید:

- **پرامپت‌دهی چندنمونه‌ای**. این تکنیک شامل دادن چند مثال به هوش مصنوعی برای نشان دادن نوع پاسخ مورد نظر شما است.

- **پرامپت‌دهی زنجیره‌ای تفکر**. این تکنیک شامل ارائه دنباله‌ای از پرامپت‌ها برای آموزش هوش مصنوعی برای حل یک کار پیچیده گام به گام است.

- **متا پرامپت‌ها**. این تکنیک شامل اضافه کردن جزئیات یا دستورالعمل‌های اضافی برای شکل‌دهی دقیق‌تر خروجی هوش مصنوعی است.

- **پرامپت‌دهی مایوتیک**. این تکنیک شامل استفاده از سوالات راهنما برای هدایت هوش مصنوعی به سمت یک پاسخ خاص است.

**شما:** جالب به نظر می‌رسد، فرض می‌کنم چند مثال به من می‌دهی؟

**سوسک زمان:** بله، همین حالا ارائه می‌دهم. بیایید برای هر یک از این تکنیک‌ها مثال‌هایی ببینیم تا بفهمیم چگونه در عمل کار می‌کنند.

### پرامپت‌دهی چندنمونه‌ای: مثال‌هایی برای هدایت خروجی هوش مصنوعی

پرامپت‌دهی چندنمونه‌ای چند مثال به مدل هوش مصنوعی می‌دهد تا خروجی آن را هدایت کند. تصور کنید در پیچ هوایی در مورد رم باستان سوال می‌پرسید. پرامپت‌های چندنمونه‌ای می‌توانند به این شکل باشند:

> "در مورد کلوسئوم رومی به من بگو." → "این یک آمفی‌تئاتر عظیم است."
>
> "زندگی در رم باستان چگونه بود؟" → "شلوغ و سخت بود."

**شما:** می‌بینم! این به هوش مصنوعی کمک می‌کند حتی در این بالا هم درست پاسخ دهد! ;)

**سوسک زمان:** دقیقاً، این یک روش محکم است. بعدی!

### پرامپت‌دهی زنجیره‌ای تفکر: استدلال گام به گام را نشان دهید

**سوسک زمان:** این تکنیک هوش مصنوعی را با نشان دادن استدلال گام به گام برای حل یک مشکل هدایت می‌کند. تصور کنید پیچ هوایی را فرود می‌آورید. می‌توانید آن را به این صورت تجزیه کنید:
- شما ۱۰۰ متر بالا هستید.
- گرانش با ۹٫۸ متر بر مجذور ثانیه می‌کشد.
- فرمول: ارتفاع = ½ * g * t².
- حل: t ≈ ۴٫۵ ثانیه تا فرود.

پرامپت شما می‌شود:
> - ۱۰۰ متر از زمین فاصله دارید  
> - گرانش: ۹٫۸ متر بر مجذور ثانیه  
> - چند ثانیه تا فرود؟  

**پاسخ: ۴٫۵ ثانیه**

**شما:** این سریع است—امیدوارم اعداد درست باشند!

**سوسک زمان:** این به هوش مصنوعی آموزش می‌دهد که گام به گام فکر کند.

**شما:** بنابراین این درباره تجزیه مشکلات برای پاسخ‌های دقیق است؟

**سوسک زمان:** بله، عالی برای کارهای پیچیده مانند یک برنامه آموزش ریاضی!

### پرامپت‌دهی مایوتیک: خروجی را برای تأیید دقت سوال کنید

**سوسک زمان:** این تکنیک از سوالات برای بررسی دقت خروجی هوش مصنوعی استفاده می‌کند. شما هر مرحله را سوال می‌کنید تا اطمینان حاصل کنید که استدلال سازگار است.

**شما:** بنابراین، همه چیز را سوال کن؟ به نظر سرگرم‌کننده می‌رسد. ;)  

**سوسک زمان:** بیایید فرود پیچ هوایی را آزمایش کنیم:
- ۱۰۰ متر بالا
- گرانش: ۹٫۸ متر بر مجذور ثانیه
- چند ثانیه تا فرود؟ (پاسخ: ۴٫۵ ثانیه)

بپرس: "چرا ۴٫۵ ثانیه؟"

> **پاسخ:**
> - ارتفاع = ۱۰۰ متر، سرعت عمودی اولیه = ۰ متر بر ثانیه، گرانش = ۹٫۸ متر بر مجذور ثانیه. 
> - استفاده از: ارتفاع = ½ * g * t².
> - حل: ۱۰۰ = ½ * ۹٫۸ * t² → t ≈ ۴٫۵ ثانیه.

**سوسک زمان:** این درباره تأیید پاسخ‌های هوش مصنوعی با سوالات پیگیری است.

**شما:** بنابراین، به آن اعتماد نکن—به جای آن با سوالات بررسی کن؟

**سوسک زمان:** دقیقاً! اطمینان حاصل می‌کند که استدلال محکم است.

## متا پرامپت‌ها: دستورالعمل‌های اضافی برای دقت اضافه کنید

**سوسک زمان:** بعدی، متا پرامپت‌ها.

**شما:** اوه، اول چای؟

**سوسک زمان:** _آه_. آن‌ها راهنمایی به پرامپت‌ها اضافه می‌کنند برای خروجی بهتر—عالی برای برنامه‌های حساس و مشتری‌محور.

در اینجا یک مثال آورده شده است:
> **متا پرامپت:** فقط از محصولات Contoso Inc. (توپ‌های بسکتبال، توپ‌های فوتبال، راکت‌های تنیس) استفاده کنید. آن را دقیق و کاربرپسند نگه دارید.
> **پرامپت:** بهترین محصولات ورزشی برای مبتدیان؟
> **پاسخ:** توپ‌های بسکتبال، توپ‌های فوتبال، و راکت‌های تنیس—عالی برای هماهنگی و چابکی.

این اطمینان حاصل می‌کند که پاسخ‌ها دقیق هستند و به محصولات Contoso پایبند هستند. بدون آن:
> **پرامپت:** بهترین محصولات ورزشی برای مبتدیان؟
> **پاسخ:** توپ‌های بسکتبال، توپ‌های فوتبال، راکت‌های تنیس، به علاوه توپ‌های فوتبال—_نه همه موارد Contoso_.

**شما:** کاربردی! پاسخ‌ها را در مسیر نگه می‌دارد، مانند قوانین برای اتوماتون من.

**سوسک زمان:** شما می‌دانید، _"فرانکنشتاین"_—اوه، هیچی!

**شما:** چی؟

**سوسک زمان:** فراموشش کن.

> *فرانکنشتاین* اثر مری شلی—۱۸۱۸، ۴۲ سال قبل از سفرهای زمانی شما. [بیشتر بخوانید](https://en.wikipedia.org/wiki/Mary_Shelley)

**شما:** بنابراین، بدون متا پرامپت یعنی هرج و مرج؟

**سوسک زمان:** بله، پاسخ‌های خارج از برند می‌گرفتید.

**شما:** فهمیدم، دقت مهم است!

## تکلیف - بیایید به قهرمانانمان کمک کنیم پیچ هوایی را فرود بیاورند

**شما:** این بخشی است که به من نشان می‌دهی چگونه پیچ هوایی را فرود بیاورم، درست است؟

**سوسک زمان:** بله، بیایید شروع کنیم. تپه تقریباً ۱۰۰ متر از موقعیت فعلی ما فاصله دارد. در اینجا نحوه تنظیم پرامپت آورده شده است:

- ارتفاع فعلی از زمین: ۱۰۰ متر
- حرکت به جلو با: ۱۰ متر بر ثانیه
- گرانش: ۹٫۸ متر بر مجذور ثانیه
- باد به سمت بالا با: ۰٫۷ متر بر ثانیه

**لئوناردو:** آیا دستگاه هوش مصنوعی تو می‌تواند در محاسبه کمک کند تا ببینیم آیا موفق می‌شویم یا نیاز به پرش زمانی دیگری داریم؟

**سوسک زمان:** می‌توانم بله، نام من جورج است، ترجیح می‌دهم به جای دستگاه این را صدا کنید. در واقع می‌خواهم آن را به شما دو نفر بسپارم تا بفهمید چگونه پرامپت را تنظیم کنید. ☺️

برنامه‌ای بسازید که موارد زیر را بپرسد:

- ارتفاع
- سرعت به جلو
- گرانش
- باد به سمت بالا
- فاصله تا تپه

از تکنیک زنجیره‌ای تفکر برای رسیدن به پاسخ استفاده کنید.

در اینجا یک پروژه شروع کننده آورده شده است [پروژه شروع کننده](/app/README.md).

## راه‌حل

برنامه‌ای در جاوااسکریپت بسازید که ورودی‌های زیر را بپرسد: 

- ارتفاع فعلی از زمین
- حرکت به جلو با متر بر ثانیه
- گرانش در متر بر مجذور ثانیه 
- باد به سمت بالا در متر بر ثانیه 
- فاصله تا تپه 

سپس از LLM استفاده کنید تا این ورودی‌ها را ترکیب کند و از تکنیک پرامپت‌دهی زنجیره‌ای تفکر استفاده کنید تا مدل را به پاسخ درست هدایت کنید.

[راه‌حل](./solution/solution.md) 

## آزمون دانش 

**سوال:** مهندسی پرامپت چیست؟ همه موارد صحیح را انتخاب کنید.

الف. مهندسی پرامپت درباره ساخت پل و جاده است.

ب. مهندسی پرامپت درباره ساخت پرامپت‌های مناسب برای دریافت خروجی مطلوب از یک مدل زبانی است.

ج. مهندسی پرامپت درباره آموزش یک مدل برای تشخیص الگوها در داده‌ها است.

[راه‌حل آزمون](./solution/solution-quiz.md)

## منابع خودآموز

- [مهندسی پرامپت](https://en.wikipedia.org/wiki/Prompt_engineering)
- [اصول مهندسی پرامپت](https://github.com/microsoft/generative-ai-for-beginners/blob/main/04-prompt-engineering-fundamentals/README.md?WT.mc_id=academic-105485-koreyst)
- [مهندسی پرامپت پیشرفته](https://github.com/microsoft/generative-ai-for-beginners/tree/main/05-advanced-prompts)
